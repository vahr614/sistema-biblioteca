<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completar Registro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light py-4 py-md-5"> <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-8 col-xl-6">
                
                <div class="card shadow border-0 rounded-3">
                    <div class="card-header bg-primary text-white text-center py-3">
                        <h4 class="mb-0 fw-bold">üéì Finalizar Registro</h4>
                    </div>
                    <div class="card-body p-4">
                        <div class="alert alert-info d-flex align-items-center" role="alert">
                            <div class="me-2">‚ÑπÔ∏è</div>
                            <div class="small">Datos validados. Por favor ingrese sus datos acad√©micos tal cual figuran en su matr√≠cula.</div>
                        </div>
                        
                        <form method="POST">
                            <div class="row g-3 mb-3">
                                <div class="col-12 col-md-6">
                                    <label class="fw-bold small form-label">APELLIDO PATERNO</label>
                                    <input type="text" name="paterno" class="form-control" required placeholder="Ej: PEREZ" oninput="this.value = this.value.toUpperCase()">
                                </div>
                                <div class="col-12 col-md-6">
                                    <label class="fw-bold small form-label">APELLIDO MATERNO</label>
                                    <input type="text" name="materno" class="form-control" required placeholder="Ej: LOPEZ" oninput="this.value = this.value.toUpperCase()">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="fw-bold small form-label">NOMBRES</label>
                                <input type="text" name="nombres" class="form-control" required placeholder="Ej: JUAN CARLOS" oninput="this.value = this.value.toUpperCase()">
                            </div>
                            
                            <div class="mb-3">
                                <label class="fw-bold small form-label">FACULTAD</label>
                                <select name="facultad" id="selectFacultad" class="form-select py-2" required>
                                    <option value="" disabled selected>Seleccione Facultad...</option>
                                    {% for f in facultades %}
                                        <option value="{{ f.id }}">{{ f.nombre }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label class="fw-bold small form-label">ESCUELA / CARRERA</label>
                                <select name="escuela" id="selectEscuela" class="form-select py-2" required disabled>
                                    <option value="" disabled selected>Primero seleccione Facultad...</option>
                                </select>
                            </div>
                            
                            <div class="mb-4">
                                <label class="fw-bold small form-label">GRADO ACAD√âMICO</label>
                                <select name="grado" class="form-select py-2" required>
                                    <option value="" disabled selected>Seleccione Grado...</option>
                                    {% for g in grados %}
                                        <option value="{{ g.nombre }}">{{ g.nombre }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <button class="btn btn-primary w-100 py-3 fw-bold rounded-3 shadow-sm">
                                GUARDAR Y GENERAR CONSTANCIA
                            </button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        const selectFacultad = document.getElementById('selectFacultad');
        const selectEscuela = document.getElementById('selectEscuela');

        selectFacultad.addEventListener('change', function() {
            const idFacultad = this.value;
            selectEscuela.disabled = false;
            selectEscuela.innerHTML = '<option value="" disabled selected>Cargando escuelas...</option>';

            fetch(`/api/escuelas/${idFacultad}`)
                .then(response => response.json())
                .then(data => {
                    selectEscuela.innerHTML = '<option value="" disabled selected>Seleccione Escuela...</option>';
                    data.forEach(escuela => {
                        const option = document.createElement('option');
                        option.value = escuela.id;
                        option.textContent = escuela.nombre;
                        selectEscuela.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                    selectEscuela.innerHTML = '<option value="" disabled selected>Error al cargar</option>';
                });
        });
    </script>
</body>
</html>